<!doctype html>
<html>
<head>
  <title>Results</title>
  <link rel="stylesheet" href="/static/style.css">
  <script>
    function toggleParsedText() {
      const section = document.getElementById('parsedText');
      section.style.display = section.style.display === 'none' ? 'block' : 'none';
    }
  </script>
</head>
<body>
  <div class="container">
    <h2>ðŸ§ª Abnormality Table</h2>
    <table>
      <tr><th>Test</th><th>Value</th><th>Ref Range</th><th>Status</th><th>Explanation</th></tr>
      {% for t in tests %}
      <tr>
        <td>{{ t.test }}</td>
        <td>{{ t.value }} {{ t.unit }}</td>
        <td>{{ t.ref_range }}</td>
        <td>{{ t.status }}</td>
        <td>{{ t.explanation }}</td>
      </tr>
      {% endfor %}
    </table>

   <h2>ðŸ§  AI-Generated Summary</h2>
      <div class="summary-box">
      {{ summary | safe }}
    </div>



    <form method="POST" action="/download">
      <input type="hidden" name="summary" value="{{ summary }}">
      <input type="hidden" name="tests" value="{{ tests|tojson }}">
      <button type="submit">ðŸ“¥ Download PDF</button>
    </form>

    <hr>
    <button onclick="toggleParsedText()">ðŸ“„ Toggle Raw Parsed Text</button>
    <pre id="parsedText" style="display: none;">{{ original }}</pre>
  </div>
</body>
</html>
